<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Files</title>
</head>
<body>
    <div id="content-container"></div>

    <script>
        // GitHub repository details
        const username = 'vlada-valko';
        const repo = 'avgust.ua';
        function getCurrentFilePath() {
    const path = window.location.pathname; // Отримати шлях поточної URL
    const fileName = path.substring(path.lastIndexOf('/') + 1); // Видобути ім'я файлу
    return decodeURIComponent(fileName.split('.')[0].toLowerCase()); // Видалити розширення, декодувати і перевести в нижній регістр
}

// Отримати ім'я файлу
const fileName = getCurrentFilePath();

// Кореневий шлях до папки, що містить підпапки, обчислений динамічно
const rootPath = `documents/education/${fileName}`;
console.log(rootPath);


        // GitHub API URL to get the contents of the root folder
        const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/${rootPath}`;

        // Fetch the list of folders from the GitHub API
        fetch(apiUrl)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                return response.json();
            })
            .then(items => {
                // Filter to get only folders
                const folders = items.filter(item => item.type === 'dir');
                folders.forEach(folder => {
                    const folderApiUrl = `https://api.github.com/repos/${username}/${repo}/contents/${rootPath}/${folder.name}`;
                    fetchFilesForFolder(folderApiUrl, folder.name);
                });
            })
            .catch(error => console.error('Error fetching folders:', error));

        function fetchFilesForFolder(apiUrl, folderName) {
            fetch(apiUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(files => {
                    createFolderBlock(folderName, files);
                })
                .catch(error => console.error('Error fetching files:', error));
        }

        function createFolderBlock(folderName, files) {
            const contentContainer = document.getElementById('content-container');

            const setDiv = document.createElement('div');
            setDiv.className = 'set';

            const titleLink = document.createElement('a');
            titleLink.className = 'index__our-values__carousel-title';
            titleLink.href = 'javascript:void(0);';
            titleLink.innerHTML = `${folderName} <i class="fa fa-plus"></i>`;
            titleLink.addEventListener('click', () => {
                contentDiv.style.display = contentDiv.style.display === 'none' ? 'block' : 'none';
            });

            const contentDiv = document.createElement('div');
            contentDiv.className = 'content';

            files.forEach(file => {
                if (file.type === 'file') {
                    const contentWrapperDiv = document.createElement('div');
                    contentWrapperDiv.className = 'content-wrapper';

                    const fileTitle = document.createElement('p');
                    fileTitle.className = 'index__our-values__carousel-title index__our-values__carousel-title-small';
                    fileTitle.innerHTML = `<img src="" alt="">${file.name}`;

                    const contentBtnsDiv = document.createElement('div');
                    contentBtnsDiv.className = 'content-btns';

                    const viewButton = document.createElement('a');
                    viewButton.className = 'education__buttons';
                    viewButton.href = file.download_url;
                    viewButton.target = '_blank';
                    viewButton.textContent = 'Ознайомитись';

                    const downloadButton = document.createElement('a');
                    downloadButton.className = 'education__buttons';
                    downloadButton.href = file.download_url;
                    downloadButton.download = '';
                    downloadButton.textContent = 'Завантажити';

                    contentBtnsDiv.appendChild(viewButton);
                    contentBtnsDiv.appendChild(downloadButton);
                    contentWrapperDiv.appendChild(fileTitle);
                    contentWrapperDiv.appendChild(contentBtnsDiv);
                    contentDiv.appendChild(contentWrapperDiv);
                }
            });

            setDiv.appendChild(titleLink);
            setDiv.appendChild(contentDiv);
            contentContainer.appendChild(setDiv);
        }
    </script>
    
</body>
</html>
